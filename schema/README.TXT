OpenIAM Database Configuration
------------------------------

This folder contains:
  01_mysql_idm_dbcreate.sql       
  02_mysql_schema_common.sql             
  03_mysql_schema_security.sql
  04_mysql_idm_data.sql
  05_mysql_idm_policy.sql
  06_activedir_config.sql
  mysql_generate_policies.sql
  mysql_remove_users.sql
  README.txt

To configure the database, simply execute scripts 01 through 06.


MIGRATING FROM EXISTING OPENIAM INSTANCE
========================================
Script 05 populates the database with the default set of policies and scripts. Previous
versions of OpenIAM would implement policies as separate groovy script files, whereas
more recent versions only allow configuring through the UI, which in turn accesses the
database backend.

To import policies into the database, drop the
                            mysql_generate_policies.sh
script into the folder containing the policy scripts. Running this script will generate
an SQL file (target file name can be specified as a command line argument) containing
all the necessary UPDATE statements for copying the script contents to their associated
rows within the POLICY table.

NOTE: this script generates UPDATE statements, meaning that the rows for the associated
policies must exist within the database. If you would like to reset the database whilst
retaining all previous policies, one must
  1. Execute mysql_generate_policies.sh to load the scripts into the database
  2. Export the table's data as a series of insert statements; for example, use:
                 mysqldump -u root -p openiam POLICY > out.sql
  3. Remove the schemas and reinstall as desired. Afterwards, execute the script
     generated in (2) instead of 05_mysql_idm_policy.sql

Alternatively, one can redefine the policy names through the webconsole GUI and then use
the script generated by mysql_generate_policies.sh to populate the tables with the
script data.